*** Begin Patch
*** Update File: app_Full_book_multi_progres_Dialog_test.py
@@
-def _load_sfx_config(path: str = "sfx.yaml") -> dict:
+def _load_sfx_config(path: str = "sfx.yaml") -> dict:
@@
-    try:
-        if os.path.exists(path):
-            with open(path, "r", encoding="utf-8") as f:
-                data = yaml.safe_load(f)
-                if isinstance(data, dict):
-                    cfg.update(data)
+    try:
+        if os.path.exists(path):
+            # Read YAML from given path
+            with open(path, "r", encoding="utf-8") as f:
+                data = yaml.safe_load(f)
+                if isinstance(data, dict):
+                    cfg.update(data)
+            # Save directory of the YAML for relative lookups (e.g. a "sound/" folder next to sfx.yaml)
+            cfg_dir = os.path.dirname(os.path.abspath(path))
+            if cfg_dir:
+                cfg.setdefault("_cfg_dir", cfg_dir)
@@
 def get_sfx_config(path: str = "sfx.yaml") -> dict:
@@
-    try:
-        if os.path.exists(path):
-            with open(path, "r", encoding="utf-8") as f:
-                data = yaml.safe_load(f)
-                if isinstance(data, dict):
-                    out.update(data)
+    try:
+        if os.path.exists(path):
+            with open(path, "r", encoding="utf-8") as f:
+                data = yaml.safe_load(f)
+                if isinstance(data, dict):
+                    out.update(data)
+            # store directory for downstream file resolution
+            cfg_dir = os.path.dirname(os.path.abspath(path))
+            if cfg_dir:
+                out.setdefault("_cfg_dir", cfg_dir)
@@
 def _load_and_process_sfx(sfx_id: str, target_sr: int) -> Tuple[int, np.ndarray]:
@@
-    # Пошук файлу: спробуємо відносно каталогу, де лежить скрипт, або відносно OUTPUT_DIR
-    possible_paths = [src_file, os.path.join(os.getcwd(), src_file), os.path.join(OUTPUT_DIR, src_file)]
+    # Пошук файлу: спробуємо кілька варіантів
+    # 1) шлях як вказано у конфігу (може бути абсолютний)
+    # 2) відносно поточної робочої директорії
+    # 3) відносно OUTPUT_DIR
+    # 4) відносно директорії sfx.yaml (якщо відомо)
+    # 5) підпапка 'sound' поруч із sfx.yaml
+    possible_paths = [src_file]
+    possible_paths.append(os.path.join(os.getcwd(), src_file))
+    possible_paths.append(os.path.join(OUTPUT_DIR, src_file))
+    # якщо в конфігурації збережено шлях до директорії sfx.yaml, використовуємо його
+    cfg_dir = cfg_all.get("_cfg_dir")
+    if cfg_dir:
+        possible_paths.append(os.path.join(cfg_dir, src_file))
+        possible_paths.append(os.path.join(cfg_dir, "sound", src_file))
+    # також пробуємо відносно директорії скрипту
+    script_dir = os.path.dirname(os.path.abspath(__file__)) if '__file__' in globals() else None
+    if script_dir:
+        possible_paths.append(os.path.join(script_dir, src_file))
+        possible_paths.append(os.path.join(script_dir, "sound", src_file))
@@
-    if not audio_path:
-        raise RuntimeError(f"Файл SFX '{src_file}' не знайдено (id: '{sfx_id}')")
+    if not audio_path:
+        tried = ", ".join([p for p in possible_paths if p])
+        raise RuntimeError(f"Файл SFX '{src_file}' не знайдено (id: '{sfx_id}'). Перевірені шляхи: {tried}")
*** End Patch
